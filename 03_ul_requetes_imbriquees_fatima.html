<!-- Démarrage SQL : repos sur OS (C:) -->

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    
    <title>Cours SQL - Requêtes de jointures /04 </title>

    <link rel="stylesheet" href="css/styles.css">
</head>

<body>

    <!-- =================================== -->

    <!-- Pour une navbar Bootstrap sans la fleche :
        https://www.it-swarm-fr.com/fr/css/comment-supprimer-la-fleche-dans-la-liste-deroulante-dans-bootstrap-4/827351415/-->

    <!-- =================================== -->


    <!-- ======= -->
    <!-- en-tête -->
    <!-- ======= -->

    <header class="container mt-4 p-4 bg-white">
        <div class="row">
            <div class="col-12 text-center">
                <h1 class="display-4 text-dark">Cours SQL - Requêtes de jointures</h1>
                <p class="lead">Jointures</p>
            </div>
        </div>
        <!-- fin row  -->
    </header>

    <!-- debut div de la row caroussel -->
    <div class="d-flex mb-4 p-4 justify-content-center">
        <!-- debut row -->
        <div class="row col-6">
            <div id="carouselExampleSlidesOnly" class="carousel slide" data-bs-ride="carousel" data-interval="2500">
                <div class="carousel-inner">

                    <div class="carousel-item active">
                        <img src="img/langage.png"class="d-block w-100" alt="logo sql">
                    </div>

                    <div class="carousel-item">
                        <img src="img/index.png"class="d-block w-100" alt="logo sql">
                    </div>

                    <div class="carousel-item">
                        <img src="img/php-apache-postgresql-logo.png"class="d-block w-100" alt="logo sql">
                    </div>

                    <div class="carousel-item">
                        <img src="img/conception-logo-sql-ou-base-données-icône-ux-app-ui-clipart-vecteur_csp49313056.webp"class="d-block w-100" alt="logo sql">
                    </div>

                    <div class="carousel-item">
                        <img src="img/sql.jpg"class="d-block w-100" alt="logo sql">
                    </div>

                    <div class="carousel-item">
                        <img src="img/php.jpg" class="d-block w-100" alt="logo php">
                    </div>

                    <div class="carousel-item">
                        <img src="img/pma.jpg" class="d-block w-100" alt="logo pma">
                    </div>               
                </div>
              </div>
        </div>
        <!-- fin row -->
    </div>
    <!-- fin div caroussel -->

    <!-- corps central avec contenu principal -->
    <main class="container-fluid mx-auto p-2 bg-light">

        <!-- aside gauche avec nav sommaire -->
        <div class="col-3 mt-5 p-5 bg-white">

            <!-- nav pour la page index : sommaire -->
            <nav id="navbar-example3" class="navbar navbar-light bg-light flex-column align-items-stretch p-3">
                <a class="navbar-brand" href="#index">Page Index - Sommaire</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link" href="#introduction">1. Introduction</a>
                    <a class="nav-link" href="#modelisation">2. Modélisation</a>
                    <a class="nav-link" href="#tables">3. Les tables </a>
                    <a class="nav-link" href="#les_colonnes">4. Les colonnes ou les champs </a>
                    <a class="nav-link" href="#les_types_de_donnees">5. Les types de données</a>
                    <a class="nav-link" href="#pk_ai_id">6. Types de données PK AI pour ID</a>
                    <a class="nav-link" href="#les_cardinalites">7. Les cardinalités</a>
                    <a class="nav-link" href="#table de jointure">8.Table de jointure</a>
                    <a class="nav-link" href="#clefs_etrangères">9. Clefs étrangères ou FK</a>
                    <a class="nav-link" href="#les_enregistrements">10. Les enrégistrements</a>
                    <a class="nav-link" href="#interroger_la_bdd">11. Intérroger la BDD </a>
                </nav>

                 <!-- nav pour la page 01_requêtes -->
                <a class="navbar-brand" href="#">Page 01 - Requêtes</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link" href="#introduction">1. Base d'une BDD</a>
                    <a class="nav-link" href="#modelisation">2. Création d'une table</a>
                    <a class="nav-link" href="#tables">3. SELECT et DISTINCT</a>
                    <a class="nav-link" href="#les_colonnes">4. Les conditions</a>
                    <a class="nav-link" href="#les_types_de_donnees">5. Les opérateurs de comparaison</a>
                    <a class="nav-link" href="#pk_ai_id">6. ORDER BY</a>
                    <a class="nav-link" href="#les_cardinalites">7. Limitation avec LIMIT</a>
                    <a class="nav-link" href="#table de jointure">8. Faire des calculs</a>
                    <a class="nav-link" href="#clefs_etrangères">9. Les conditions multiples</a>
                    <a class="nav-link" href="#les_enregistrements"> Les regroupements</a>
                </nav>

                <!-- nav pour la page 02_requêtes -->
                <a class="navbar-brand" href="#">Page 02 - Requêtes</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link" href="#INSERT INTO, insertion">1. INSERT INTO, insertion</a>
                    <a class="nav-link" href="#modelisation">2. UPDATE, mise à jour</a>
                    <a class="nav-link" href="#tables">3. DELETE, effacer</a>
                    <a class="nav-link" href="#les_colonnes">4. Exo</a>
                </nav>

                <!-- nav pour la page 03_requêtes imbriquées -->
                <a class="navbar-brand" href="#">Page 03 - Requêtes imbriquées</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link" href="#">1. </a>
                    <a class="nav-link" href="#">2. </a>
                    <a class="nav-link" href="#">3. </a>
                    <a class="nav-link" href="#">4. </a>
                </nav>

                <!-- nav pour la page 04_jointures -->
                <a class="navbar-brand" href="#">Page 04 - Jointures</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link" href="#">1. </a>
                    <a class="nav-link" href="#">2. </a>
                    <a class="nav-link" href="#">3. </a>
                    <a class="nav-link" href="#">4. </a>
                </nav>

                <!-- nav pour la page 05_exos -->
                <a class="navbar-brand" href="#">Page 05 - exos</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link" href="#">1. </a>
                    <a class="nav-link" href="#">2. </a>
                    <a class="nav-link" href="#">3. </a>
                    <a class="nav-link" href="#">4. </a>
                </nav>
            </nav>
        </div>

        <!-- ================================================ -->
        <!-- section container : zoning avec contenu principal-->
        <!-- ================================================ -->
    
        <section class="container mb-4 col-9">

            <!-- debut row 1 -->
            <div class="row mt-3">
                <h2 id="" class="text-dark p-5">1. Définition"</h2>

                <dl>
                    <dt>Les jointures</dt>
                        <dd>Les jointures permettent, comme les requêtes imbriquées d'effectuer les requêtes sur plusieurs tables. Il faut un champ commun aux différentes tables. L'avantage des jointures est que l'on peut obtenir un résultat final des colonnes ou champs issus de plausieurs tables différentes.</dd>
                </dl>
            </div>

            <!-- fin row -->



                <p><code>NULL</code> : le code peut être vide;</p>
                <p><code>NOT NULL</code> : le code ne peut pas être vide;</p>
                
                <div class="col-5 m-5">
                    <figure>
                        <img src="img/abonne.png" class="image" alt="tableau abonné">
                        <figcaption class="text-center">La table abonné</figcaption>
                    </figure>
                </div>
                <!-- fin col -->

                <div class="col-4 m-5">
                    <h4>Création de la table abonné : </h4><br>
                        <code>CREATE TABLE abonne (
                        id_abonne INT(3) NOT NULL AUTO_INCREMENT,
                        prenom VARCHAR(20) NOT NULL,
                        PRIMARY KEY (id_abonne)
                        ) ENGINE=InnoDB;</code>

                        <hr>

                        <p><code>NULL</code> : le code peut être vide;</p><br>
                        <p><code>NOT NULL</code> : le code ne peut pas être vide;</p><br>
                </div>
                <!-- fin col -->
            </div>
            <!-- fin row 1 -->

            <!-- debut row 2 -->
            <div class="row mt-3">
                <div class="col-5 m-5">
                    <figure>
                        <img src="img/livre.png" class="image" alt="tableau livre">
                        <figcaption class="text-center">La table livre</figcaption>
                    </figure>
                </div>
                 <!-- fin col -->

                <div class="col-4 m-5">
                    <h4>Création de la table livre : </h4> <br>

                    <li>
                        <code>CREATE TABLE livre (
                            id_livre INT(3) NOT NULL AUTO_INCREMENT,
                            auteur VARCHAR(30) NOT NULL,
                            titre VARCHAR(30) NOT NULL,
                            PRIMARY KEY (id_livre)
                            ) ENGINE=InnoDB;
                            </code>
                    </li><br>

                    <li><code>DESCRIBE livre;</code></li><br>

                </div>
                <!-- fin col -->
            </div>
            <!-- fin row 2 -->

            <!-- debut row 3 -->
            <div class="row mt-3">
                <div class="col-5 m-5">
                    <figure>
                        <img src="img/contenu_livre.jpg" class="image" alt="contenu table livre">
                        <figcaption class="text-center">Contenu table livre</figcaption>
                    </figure>
                </div>
                 <!-- fin col -->

                <div class="col-4 m-5">
                    <h4>Insertion contenu table livre : </h4> <br>
                        <code>INSERT INTO livre (id_livre, auteur, titre) VALUES
                            (100, 'GUY DE MAUPASSANT', 'Une vie'),
                            (101, 'GUY DE MAUPASSANT', 'Bel-Ami '),
                            (102, 'HONORE DE BALZAC', 'Le père Goriot'),
                            (103, 'ALPHONSE DAUDET', 'Le Petit chose'),
                            (104, 'ALEXANDRE DUMAS', 'La Reine Margot'),
                            (105, 'ALEXANDRE DUMAS', 'Les Trois Mousquetaires')</code><br>
                </div>
                <!-- fin col -->
            </div>
            <!-- fin row 3 -->


            <!-- debut row 4 -->
            <div class="row mt-3">
                <div class="col-5 m-5">
                    <figure>
                        <img src="img/emprunt.png" class="image" alt="tableau emprunt">
                        <figcaption class="text-center">La table emprunt</figcaption>
                    </figure>
                </div>
                 <!-- fin col -->

                <div class="col-4 m-5">
                    <h4>Création de la table emprunt : </h4> <br>
                        
                    <li>
                        <code>CREATE TABLE emprunt (
                            id_emprunt INT(3) NOT NULL AUTO_INCREMENT,
                            id_livre INT(3) DEFAULT NULL,
                            id_abonne INT(3) DEFAULT NULL,
                            date_sortie DATE NOT NULL,
                            date_rendu DATE DEFAULT NULL,
                            PRIMARY KEY (id_livre)
                            ) ENGINE=InnoDB;
                        </code>
                    </li><br>

                    <li>Avec DESCRIBE on demande à voir les descriptions des tables créés : <code> DESCRIBE emprunt;</code></li>
                      
                </div>
                <!-- fin col -->
            </div>
            <!-- fin row 4 -->


            <!-- debut row 5 -->
            <div class="row mt-3">
                <div class="col-5 m-5">
                    <figure>
                        <img src="img/contenu_emprunt.jpg" class="image" alt="contenu table emprunt">
                        <figcaption class="text-center">Contenu table emprunt</figcaption>
                    </figure>
                </div>
                 <!-- fin col -->

                <div class="col-4 m-5">
                    <h4>Insertion du contenu sur table emprunt : </h4> <br>
                        <code>INSERT INTO emprunt (id_emprunt, id_livre, id_abonne, date_sortie, date_rendu) VALUES
                            (1, 100, 1, '2014-12-17', '2014-12-18'),
                            (2, 101, 2, '2014-12-18', '2014-12-20'),
                            (3, 100, 3, '2014-12-19', '2014-12-22'),
                            (4, 103, 4, '2014-12-19', '2014-12-22'),
                            (6, 105, 2, '2015-03-20', '2015-03-26'),
                            (7, 105, 3, '2015-06-13', NULL),
                            (8, 100, 2, '2015-06-15', NULL)</code><br>
                </div>
                <!-- fin col -->
            </div>
            <!-- fin row 5 -->


            <!-- debut row 6 -->
            <div class="row mt-3">
                <h3>Création clé étrangère</h3><br>

                <div class="col-4 m-3">
                    <figure>
                        <img src="img/designer.png" class="image" alt="capture ecran plateforme SQL_index de clés etreangères">
                        <figcaption class="text-center">Modélisation des tables <br>
                        (Index des 2 clés étrangères id_livre et id_abonne)</figcaption>
                    </figure>
                </div>
                 <!-- fin col -->

                <div class="col-5 m-3">
                    <h4>Pour altérer/changer : ajouter clé étrangère direct sur la console PHPmyAdmin :</h4><br>
                    <ul>          
                        <li><code>ALTER table emprunt ADD FOREIGN  KEY(id_livre) REFERENCES bibliotheque.livre(id_livre);</code></li><br>
                        <li><code>ALTER TABLE emprunt ADD FOREIGN KEY(id_abonne) REFERENCES bibliotheque.abonne(id_abonne)</code></li><br>
                    </ul>
                </div>
                <!-- fin col -->
            </div>
            <!-- fin row 6 -->

            <div class="row mt-4">
                <h2>2- SELECT sur plusieurs tables : requêtes imbriquées avec <code>IS</code> ou <code>IN</code> ou <code>NOT IN</code></h2>
                <div class="col-4 m-5">
                    <ul>
                        <li><code>SELECT * FROM abonne;</code></li>
                        <li><code>SELECT * FROM livre; </code></li>
                        <li><code>SELECT * FROM emprunt; </code></li>
                    </ul>
                </div>
                <!-- fin col -->
            </div>
            <!-- fin row -->

            <div class="row">
                <div class="col-10 m-5">
                    <ul>
                        <li>On cherche les livres qui n'ont pas été rendu :<code>SELECT * FROM emprunt WHERE date_rendu IS NULL;</code> : attention cas particulier la valeur NULL se teste avec le mot clef IS!</li>
                        <li>Quelles sont les titres des livres qui n'ont pas été rendus? : <code>SELECT * FROM livre WHERE id_livre IN (SELECT id_livre FROM emprunt WHERE date_rendu IS NULL);</code> nous cherchons des informations dans les tables livre et emprunt , la requete entre parenthèses s'execute en premier, et nous donne l'id des livres de la table 'emprunt', puis nous demandons les titres des livres correspondant aux id des livres de la première requête.</li>
                        <li class="alert alert-danger">ATTENTION!!!!!! <br>
                        Pour qu'une requête imbriquée sur 3 tables soit possible il faut absolument qu'une information soit commune aux 2 tables : ici l'id_livre !! Le champ id_livre nous sert 'à joindre' et faire correspondre les informations</li>
                        <li>Afficher les prénoms des abonnés ayant empruntés des livres le 19/12/2014 :<code>SELECT * FROM abonne WHERE id_abonne IN(SELECT id_abonne FROM emprunt WHERE date_sortie = '2014-12-19');</code></li>
                        <li>Afficher les prénoms des abonnés ayant empruntés le livre d'Alphonse Daudet :<code>SELECT prenom FROM abonne WHERE id_abonne IN(SELECT id_abonne FROM emprunt WHERE id_livre IN(SELECT id_livre FROM livre WHERE auteur = 'ALphonse Daudet'));</code> <br>
                            La dernière requête s'execute en premier et nous sort de la table "livre les id  des livres de Daudet" puis la requete du milieu nous sort les id des abonnés ayant empruntés ce livre et enfin la première requete nous donne leurs prénoms.
                        </li>
                        <li>Afficher le/les livre(s) empruntée par Chloé :<code>SELECT titre FROM livre WHERE id_livre IN(SELECT id_livre FROM emprunt WHERE id_abonne =(SELECT id_abonne FROM abonne WHERE prenom = 'Chloé'));</code></li>
                        <li>Afficher le(s) titre(s) de(s) livre(s) que Chloé n'as pas empruntée:<code>SELECT titre FROM livre WHERE id_livre NOT IN(SELECT id_livre FROM EMPRUNT WHERE id_abonne =(SELECT id_abonne FROM abonne WHERE prenom = 'Chloé'));</code></li>
                        <li>Afficher le titre du livre qu'elle n'as pas rendu :<code>SELECT titre FROM livre WHERE id_livre IN(SELECT id_livre FROM emprunt WHERE date_rendu IS NULL AND id_abonne=(SELECT id_abonne FROM abonne WHERE prenom ='Chloé'));</code></li>
                        <li>Combien de livres a emprunté Guillaume :<code>SELECT COUNT(*) AS 'nombre de livre' FROM emprunt WHERE id_abonne=(SELECT id_abonne FROM abonne WHERE prenom ='Guillaume');</code></li>

                    </ul>
                    
                </div>
        </section>
        <!-- fin container -->      
    </main>
    <!-- fin corps central -->


    <!-- =================================== -->
    <!-- pied de page -->
    <!-- =================================== -->
    
        <!-- Ajouter "container" if you want to extend the Footer to full width/ou container-fluid -->
    <div class="p-5 my-5">

        <footer class="text-center text-lg-start bg-jaune">
            <!-- <div class="container d-flex justify-content-center py-5">
                <button type="button" class="btn-lg btn-floating mx-2" style="background-color: #54456b;">
                <i class="fab fa-facebook-f"></i>
                </button>
    
                <button type="button" class="btn btn-primary btn-lg btn-floating mx-2" style="background-color: #54456b;">
                <i class="fab fa-youtube"></i>
                </button>
    
                <button type="button" class="btn btn-primary btn-lg btn-floating mx-2" style="background-color: #54456b;">
                <i class="fab fa-instagram"></i>
                </button>
    
                <button type="button" class="btn btn-primary btn-lg btn-floating mx-2" style="background-color: #54456b;">
                <i class="fab fa-twitter"></i>
                </button>
            </div> -->

            <!-- Copyright -->
            <div class="text-center text-dark p-5 m-5" style="background-color: rgba(0, 0, 0, 0.2);">
                &copy; Colombbus 2021-2022 :
                <a class="text-dark" href="https://mdbootstrap.com/">Agence Suresnes</a>
            </div>
            <!-- Copyright -->     
        </footer>    
  </div>
  <!-- fin div container/fluid du footer -->

    <!-- Optional JavaScript -->
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>
</body>
</html>